
<!DOCTYPE html>

<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>H√≥a ƒë∆°n</title>
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/jquery-3.7.1.min.js"></script>
<link href="../css/home.css" rel="stylesheet"/>
<script src="../js/register.js"></script>
<script src="../js/invoice.js"></script>
<style>
  @media print {
    header, footer, .btn, .navbar, .btn-secondary {
      display: none !important;
    }
    body {
      margin: 0;
    }
    main {
      padding: 0 !important;
    }
  }
</style>

</head>
<body>
  <header class="navbar navbar-expand-lg navbar-light py-3">
    <div class="container-fluid px-5">
      <a class="navbar-brand" href="../index.html">
        <img alt="logo" src="../img/logo1.png" style="height: 200px;"/>
        <div class="brand-text">
          <span class="brand-title">LUNAR</span>
          <span class="brand-tagline">Soft as moonlight.</span>
        </div>
      </a>
    <button class="navbar-toggler" data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0 navigation">
        <li class="nav-item">
          <a class="nav-link" href="../index.html">Trang ch·ªß</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="../html/products.html" id="productDropdown" role="button">S·∫£n ph·∫©m</a>
          <ul aria-labelledby="productDropdown" class="dropdown-menu"><li><a class="dropdown-item" href="products.html?cat=bbnhua">B√∫p b√™ nh·ª±a</a></li><li><a class="dropdown-item" href="products.html?cat=bbvai">B√∫p b√™ v·∫£i</a></li><li><a class="dropdown-item" href="products.html?cat=thubong">Th√∫ b√¥ng</a></li></ul>
          <li class="nav-item">
            <a class="nav-link" href="../html/about.html">V·ªÅ ch√∫ng t√¥i</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../html/shipping.html">ƒê∆°n h√†ng</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../html/login.html">ƒêƒÉng nh·∫≠p</a>
          </li>
        </li>
      </ul>
      <a class="btn btn-warning" href="../html/cart.html">Gi·ªè h√†ng</a>
      </div>
    </div>
  </header>
  <main>
    <div class="container py-5">
      <div class="bg-white p-4 rounded shadow">
        <h2 class="text-center mb-4">üßæ H√≥a ƒë∆°n mua h√†ng</h2>
        <div id="invoiceContent"></div>
        <div class="text-center mt-4">
          <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è In h√≥a ƒë∆°n</button>
          <a href="../index.html" class="btn btn-secondary">Quay v·ªÅ trang ch·ªß</a>
        </div>
      </div>
    </div>
  </main>
  <footer class="bg-dark py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <h5 class="text-danger">Lunar Shop</h5>
          <p class="text-info">Th·∫ø gi·ªõi c·ªßa b√∫p b√™ v√† th√∫ b√¥ng ƒë√°ng y√™u!</p>
        </div>
        <div class="col-md-3">
          <h5 class="text-danger">Quick Links</h5>
          <ul class="list-unstyled">
            <li><a class="text-success" href="../index.html">Home</a></li>
            <li><a class="text-success" href="../products.html">Products</a></li>
            <li><a class="text-success" href="../about.html">About</a></li>
          </ul>
        </div>
        <div class="col-md-3">
          <h5 class="text-danger">Our Services</h5>
          <ul class="list-unstyled">
            <li><a class="text-primary" href="../shipping.html">Shipping</a></li>
            <li><a class="text-primary" href="../cart.html">Cart</a></li>
            <li><a class="text-primary" href="../checkout.html">Checkout</a></li>
          </ul>
        </div>
        <div class="col-md-3">
          <h5>Nh·∫≠n th√¥ng b√°o v·ªÅ s·∫£n ph·∫©m m·ªõi</h5>
          <form id="footerSubscribeForm">
            <input class="form-control mb-2" id="footerSubscribeEmail" placeholder="Enter your email" required="" type="email"/>
            <button class="btn btn-warning w-100" type="submit">Submit</button>
          </form>
        </div>
      </div>
    </div>
  </footer>
  <div aria-hidden="true" class="modal fade" id="footerThankModal" tabindex="-1">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body text-center">
          <h5 class="mb-3">C·∫£m ∆°n b·∫°n ƒë√£ ƒëƒÉng k√Ω!</h5>
          <p>Khi c√≥ s·∫£n ph·∫©m m·ªõi, ch√∫ng t√¥i s·∫Ω g·ª≠i th√¥ng b√°o ƒë·∫øn b·∫°n.</p>
          <button class="btn btn-primary" data-bs-dismiss="modal" type="button">ƒê√≥ng</button>
        </div>
      </div>
    </div>
  </div>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const invoiceData = JSON.parse(localStorage.getItem("invoiceData"));
    const invoiceContent = document.getElementById("invoiceContent");

    if (!invoiceData) {
      invoiceContent.innerHTML = "<p class='text-center text-danger'>Kh√¥ng c√≥ d·ªØ li·ªáu h√≥a ƒë∆°n!</p>";
      return;
    }

    const { name, phone, address, method, bankInfo, cart } = invoiceData;
    let total = 0;

    let html = `
      <p><strong>H·ªç v√† t√™n:</strong> ${name}</p>
      <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> ${phone}</p>
      <p><strong>ƒê·ªãa ch·ªâ:</strong> ${address}</p>
      <p><strong>Ph∆∞∆°ng th·ª©c thanh to√°n:</strong> ${method}</p>
    `;

    if (method === "ATM" && bankInfo) {
      html += `
        <p><strong>T√™n ng√¢n h√†ng:</strong> ${bankInfo.name}</p>
        <p><strong>S·ªë t√†i kho·∫£n:</strong> ${bankInfo.number}</p>
        <p><strong>Ch·ªß t√†i kho·∫£n:</strong> ${bankInfo.holder}</p>
      `;
    }

    html += "<hr/><h5>Chi ti·∫øt s·∫£n ph·∫©m:</h5><table class='table'><thead><tr><th>T√™n s·∫£n ph·∫©m</th><th>S·ªë l∆∞·ª£ng</th><th>ƒê∆°n gi√°</th><th>Th√†nh ti·ªÅn</th></tr></thead><tbody>";

    cart.forEach(item => {
      const price = typeof item.price === 'number' ? item.price : parseInt(item.price.replace(/\D/g, ""));
      const lineTotal = price * item.quantity;
      total += lineTotal;
      html += `
        <tr>
          <td>${item.title}</td>
          <td>${item.quantity}</td>
          <td>${price.toLocaleString()}ƒë</td>
          <td>${lineTotal.toLocaleString()}ƒë</td>
        </tr>
      `;
    });

    html += `</tbody></table><p class='text-end fw-bold'>T·ªïng c·ªông: ${total.toLocaleString()}ƒë</p>`;
    invoiceContent.innerHTML = html;
  });
  document.addEventListener("DOMContentLoaded", function () {
      const footerForm = document.getElementById("footerSubscribeForm");
      const footerEmail = document.getElementById("footerSubscribeEmail");
    
      footerForm?.addEventListener("submit", function (e) {
        e.preventDefault();
        const email = footerEmail.value.trim();
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
        if (re.test(email)) {
          const modal = new bootstrap.Modal(document.getElementById("footerThankModal"));
          modal.show();
          footerForm.reset();
        } else {
          footerEmail.classList.add("is-invalid");
          if (!footerEmail.nextElementSibling || !footerEmail.nextElementSibling.classList.contains("invalid-feedback")) {
            const error = document.createElement("div");
            error.className = "invalid-feedback";
            error.innerText = "Vui l√≤ng nh·∫≠p email h·ª£p l·ªá.";
            footerEmail.parentNode.insertBefore(error, footerEmail.nextSibling);
          }
        }
      });
    
      footerEmail?.addEventListener("input", function () {
        footerEmail.classList.remove("is-invalid");
        const error = footerEmail.parentNode.querySelector(".invalid-feedback");
        if (error) error.remove();
      });
    });
</script>
</body>

</html>
